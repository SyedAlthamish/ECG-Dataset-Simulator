import matplotlib.pyplot as plt

"""Importions """
import serial
import wfdb
import time
import matplotlib.pyplot as plt

def upsample_linear(data, upsample_factor):
    """Upsamples the given data array using linear interpolation.

    Args:
        data (list or np.array): The input data array to be upsampled.
        upsample_factor (int): The factor by which to upsample the data.

    Returns:
        np.array: The upsampled data array.
    """
    import numpy as np

    original_indices = np.arange(len(data))
    upsampled_indices = np.linspace(0, len(data) - 1, len(data) * upsample_factor)

    upsampled_data = np.interp(upsampled_indices, original_indices, data)
    return upsampled_data

# Example usage
def normalize_to_255(data):
    if not data:
        return []

    min_val = min(data)
    max_val = max(data)  # int((2.5/3.3)*65535)
    print(max_val)
    # If all values are the same, normalization would cause a divide-by-zero error
    if min_val == max_val:
        return [0 for _ in data]

    normalized_data = [(value - min_val) / (max_val - min_val) for value in data]
    print(normalized_data)
    scaled_data = [(int((value * (255-155))+125)) for value in normalized_data]

    return scaled_data


def normalize_to_255_adcdata(data):
    if not data:
        return []

    min_val = 0
    max_val = 33492  # int((2.5/3.3)*65535)
    print(max_val)
    # If all values are the same, normalization would cause a divide-by-zero error
    if min_val == max_val:
        return [0 for _ in data]

    normalized_data = [(value - min_val) / (max_val - min_val) for value in data]
    scaled_data = [int(value * 255) for value in normalized_data]

    return scaled_data


def get_dataset():
    ################Selecting The DB#################################
    recordname = str(100)  # str(input("Please select one record from 100-124 and 200-234"))

    ################Accessing   The   DB###################################
    print("importion done")
    record = wfdb.rdrecord(
        "C:\Althamish\Project\ECG Simulator\mit-bih-arrhythmia-database-1.0.0\mit-bih-arrhythmia-database-1.0.0\\" + recordname)
    # Read the annotations
    annotation = wfdb.rdann(
        "C:\Althamish\Project\ECG Simulator\mit-bih-arrhythmia-database-1.0.0\mit-bih-arrhythmia-database-1.0.0\\100",
        'atr')

    all_samples = record.p_signal[:, 0]
    print("Record accessed")
    data = all_samples

    #################Normalising Selected Data for 8bit DAC###########################
    # print(data)
    normaldata = ((data - min(data)) / (max(data) - min(data)) * (250 - 5)) + (5)
    normaldata = [int(x) for x in normaldata]
    # print("Selected Data samples: ",normaldata)

    downsampleddata = normaldata[0:len(normaldata):2]

    # print(downsampleddata)
    # print(len(downsampleddata),len(normaldata))
    # plt.plot(downsampleddata)
    # plt.plot(normaldata)
    # plt.show()
    return downsampleddata

def downsampled(hi):
    return hi[0:len(hi):2]

unsampleddata=normalize_to_255([18644, 18372, 19012, 19028, 18996, 19284, 19124, 19172, 19220, 19364, 19172, 19044, 19028, 19028, 18964, 19092, 18884, 18916, 19012, 19076, 18980, 19092, 19236, 19044, 18836, 18804, 18980, 19076, 19028, 19188, 19108, 19028, 19012, 19076, 19092, 19108, 18884, 19140, 18884, 18884, 18788, 18884, 19028, 19108, 18996, 19156, 18980, 18756, 18868, 18868, 18996, 18884, 18980, 19012, 18980, 19268, 19140, 19076, 19156, 19172, 19092, 18724, 18916, 18820, 18740, 19076, 19188, 18948, 18964, 19028, 19044, 19044, 19252, 19236, 19252, 18900, 18900, 18676, 18708, 18980, 18948, 18980, 18772, 18852, 18884, 18788, 19044, 18916, 18644, 19108, 18660, 18804, 18628, 18772, 18820, 18964, 18804, 18692, 18660, 18772, 18468, 18580, 18516, 18596, 18500, 18500, 18692, 18596, 18516, 18708, 18692, 18788, 18532, 18692, 18532, 18436, 18596, 18596, 18724, 18692, 18724, 19044, 18964, 19300, 19300, 19636, 19204, 19204, 19460, 19236, 19652, 19556, 19684, 19428, 19492, 19892, 19812, 19732, 19860, 19940, 19524, 19540, 19604, 19620, 19620, 19684, 19812, 19764, 19588, 19812, 19908, 20004, 19716, 19540, 19684, 19604, 19620, 19556, 19668, 19620, 19684, 19732, 19748, 19716, 19812, 19492, 19492, 19716, 19812, 19588, 19524, 19732, 19556, 19652, 19732, 19732, 19972, 19508, 19428, 19524, 19572, 19684, 19604, 19684, 19620, 19556, 19588, 19684, 19748, 19396, 19268, 19380, 19188, 19300, 19268, 19348, 19428, 19652, 19476, 19476, 19556, 19588, 19172, 19348, 19396, 19364, 19380, 19412, 19524, 19524, 19604, 19508, 19620, 19492, 19588, 19364, 19332, 19348, 19412, 19412, 19396, 19428, 19476, 19492, 19476, 19620, 19636, 19156, 19300, 19252, 19300, 19284, 19396, 19556, 19492, 19364, 19444, 19588, 19396, 19428, 19364, 19492, 19428, 19460, 19620, 19588, 19540, 19540, 19716, 19508, 19428, 19364, 19460, 19460, 19652, 19508, 19860, 19844, 19764, 19892, 19860, 20308, 20244, 20324, 20292, 19876, 20020, 20148, 20324, 20292, 20180, 20517, 20420, 20404, 20485, 20549, 20613, 20228, 20068, 20148, 20164, 20116, 20100, 20164, 20196, 20709, 20581, 20613, 20004, 19924, 19876, 19908, 19876, 19716, 19860, 19508, 19588, 18756, 19684, 19540, 19204, 19332, 19380, 19300, 19268, 19380, 19300, 19364, 19300, 19364, 19188, 19252, 19108, 19124, 18996, 19156, 19076, 19156, 19124, 19492, 19492, 19556, 19172, 19236, 18788, 18884, 19092, 18340, 18436, 17892, 17956, 17620, 17668, 17620, 19092, 19124, 21701, 21157, 21429, 25526, 25606, 29703, 29767, 29575, 29655, 29399, 22917, 22933, 17988, 18052, 18068, 18612, 18692, 19012, 18964, 19012, 18948, 19076, 18996, 19156, 18836, 18756, 18884, 19092, 18980, 18980, 18932, 18996, 18980, 19076, 19236, 19140, 19076, 18820, 18868, 18788, 18868, 19012, 18852, 18996, 18980, 18900, 19092, 18980, 18948, 18740, 18852, 18756, 18772, 18964, 18788, 18852, 18852, 19044, 18852, 18980, 19044, 19092, 18708, 18884, 18948, 18852, 18980, 18852, 19012, 18916, 19124, 19012, 19108, 19124, 18660, 19156, 18724, 18772, 18788, 18756, 18980, 18900, 18964, 18996, 18964, 19140, 18820, 18916, 18884, 18948, 18964, 19012, 19012, 19092, 18996, 18868, 19140, 19076, 18916, 19076, 19108, 19076, 18884, 19220, 19140, 19044, 19124, 19012, 18532, 18708, 18708, 18788, 18852, 18820, 18772, 18852, 18772, 18756, 18772, 18484, 18596, 18692, 18932, 18756, 18868, 18820, 18932, 18980, 18852, 18996, 19172, 18996, 19012, 19332, 19268, 19332, 19396, 19524, 19556, 19588, 19684, 19764, 19716, 19988, 19636, 19636, 19556, 19620, 19748, 19684, 19924, 19892, 19908, 19860, 19796, 19620, 19476, 19556, 19700, 19780, 19748, 19716, 19652, 19764, 19780, 19940, 19684, 19540, 19524, 19268, 19716, 19812, 20004, 19924, 19844, 19716, 19844, 19652, 19780, 19796, 19716, 19748, 19556, 19156, 19460, 19476, 19364, 19524, 19380, 19524, 19636, 19604, 19460, 19524, 19140, 19204, 19348, 19300, 19236, 19396, 19156, 19492, 19540, 19636, 19476, 19428, 18980, 19028, 19300, 19428, 19396, 19204, 19236, 19268, 19284, 19428, 19364, 19108, 19140, 19076, 19204, 19268, 19332, 19412, 19460, 19588, 19460, 19508, 19332, 19204, 19380, 19140, 19252, 19332, 19348, 19444, 19396, 19412, 19428, 19636, 19348, 19028, 19364, 19300, 19300, 19412, 19348, 19300, 19332, 19556, 19428, 19428, 19460, 19556, 19220, 19236, 19412, 19476, 19492, 19764, 19764, 19876, 19764, 19764, 20148, 20228, 19700, 19924, 19796, 19908, 19908, 20148, 20068, 20116, 20244, 20228, 20164, 20244, 20372, 19812, 19652, 20164, 20004, 19972, 19748, 20036, 19940, 19940, 20292, 20148, 20244, 20549, 20196, 19972, 19796, 19860, 19652, 19652, 19540, 19412, 19460, 19140, 19220, 19588, 19284, 18980, 18868, 18980, 18868, 18980, 19156, 19076, 19140, 18980, 19028, 19076, 19220, 19348, 18996, 19108, 18820, 18884, 19028, 18916, 18948, 19124, 19252, 19076, 18980, 18724, 18212, 18244, 17988, 18052, 17828, 17956, 17972, 17188, 16996, 17732, 17684, 17604, 19236, 19220, 21557, 21461, 21205, 25190, 25350, 29063, 29111, 28775, 28807, 28807, 23045, 22997, 18276, 18308, 17972, 18244, 18388, 19140, 18980, 19044, 18980, 19044, 19124, 18964, 19236, 19076, 18996, 19028, 18900, 19012, 18884, 18964, 19220, 19204, 19044, 19076, 19204, 18756, 18708, 18820, 18884, 18948, 18980, 19108, 19012, 18948, 19268, 19316, 19236, 18820, 18788, 18836, 18884, 18980, 18868, 19012, 18996, 19028, 18980, 19076, 19140, 19220, 18964, 19028, 18996, 19076, 19076, 19012, 19172, 19236, 19156, 19172, 19844, 18852, 18948, 19204, 19044, 19204, 18884, 18964, 19204, 19268, 19172, 19380, 19460, 18772, 18756, 19092, 19012, 19044, 19108, 19140, 19252, 19268, 19204, 19492, 19012, 19060, 19108, 19092, 18948, 18964, 19284, 19252, 19348, 19364, 19412, 19284, 18916, 19172, 19204, 19140, 18964, 18980, 19092, 19172, 19268, 19364, 19252, 19380, 19364, 18980, 18740, 18836, 19092, 19108, 19268, 19252, 19284, 19348, 19460, 19684, 19652, 19396, 19508, 19636, 18852, 18900, 19044, 19028, 18964, 18884, 18900, 19092, 19156, 18868, 18996, 18948, 18948, 19028, 19092, 18980, 18916, 19044, 18996, 19044, 18692, 18692, 18692, 18772, 18740, 18884, 18916, 19044, 18948, 19076, 19076, 18724, 18852, 18948, 18948, 18852, 18996, 18916, 18964, 18996, 19028, 19076, 18948, 19252, 18820, 18884, 18740, 18804, 18724, 18436, 18676, 18756, 18692, 18948, 18772, 18916, 18564, 18596, 18612, 18532, 18836, 18660, 18628, 18628, 18612, 18868, 18852, 18532, 18500, 18788, 19028, 19076, 19620, 19556, 19556, 19860, 19764, 19796, 19364, 19476, 19716, 19748, 19972, 19924, 19892, 19796, 19636, 20068, 20100, 20004, 19396, 19588, 19780, 19732, 19860, 19956, 20132, 20100, 20084, 20132, 20036, 20196, 19988, 19908, 19876, 20020, 19972, 19972, 19940, 20132, 19988, 20036, 20036, 20116, 19940, 19892, 19652, 19604, 19684, 19876, 19860, 19908, 19796, 19844, 19892, 19892, 19940, 19924, 19492, 19476, 19444, 19556, 19668, 19732, 19668, 19764, 19684, 19684, 19796, 19844, 19588, 19604, 19508, 19460, 19364, 19684, 19476, 19844, 19796, 19908, 19604, 19396, 19636, 19604, 19572, 19540, 19604, 19604, 19620, 19652, 19844, 19892, 19684, 19508, 19460, 19476, 19412, 19620, 19668, 19844, 19716, 19668, 19668, 19748, 19588, 19476, 19524, 19380, 19524, 19588, 19684, 19604, 19588, 19652, 19716, 19444, 19396, 19364, 19492, 19604, 19604, 19652, 19716, 19780, 19716, 19636, 19604, 19492, 19764, 19716, 19716, 19636, 19636, 20148, 20164, 20228, 20356, 20388, 20036, 20036, 20260, 20372, 20372, 20308, 20404, 20645, 20645, 20629, 20741, 20549, 20581, 20485, 20629, 20244, 20356, 20324, 20452, 20533, 20501, 20581, 20036, 20148, 20404, 20452, 20452, 20420, 20613, 20164, 20244, 20260, 20036, 20052, 19524, 19540, 19492, 19508, 19764, 19492, 19668, 19620, 19620, 19764, 19492, 19332, 19316, 19412, 19652, 19524, 19684, 19364, 19508, 19556, 19396, 19588, 19652, 19652, 19332, 19204, 19124, 19460, 19492, 19620, 19588, 19556, 19460, 19572, 19460, 19220, 18660, 18516, 18644, 18244, 18260, 17972, 17892, 18004, 19028, 19028, 21029, 20965, 24565, 24565, 24565, 29063, 29159, 30087, 30087, 30343, 26150, 26182, 19924, 19540, 18436, 18308, 18324, 19092, 18948, 19668, 19396, 19428, 19204, 19172, 19620, 19396, 19092, 19108, 19268, 19076, 19124, 19412, 19172, 19396, 19396, 19300, 19076, 18900, 18724, 19028, 19108, 19284, 19188, 19124, 18980, 19028, 19108, 19220, 18932, 18948, 18852, 18996, 18596, 19028, 18964, 19092, 19236, 19252, 19348, 18756, 18868, 19012, 18980, 19220, 19188, 19156, 19124, 19124, 19492, 19460, 19492, 19220, 19140, 19140, 19092, 19108, 19012, 19332, 19348, 19332, 19268, 19300, 18820, 18980, 19044, 19156, 19284, 19124, 18980, 19012, 19268, 19300, 19236, 19140, 19044, 18948, 18964, 19044, 19108, 19332, 19332, 19268, 19252, 19172, 19460, 19380, 19012, 19220, 19140, 18852, 18916, 19092, 19412, 18948, 19380, 19412, 19236, 19380, 18996, 19028, 18948, 19236, 19268, 19204, 19028, 19012, 19380, 19412, 19380, 19396, 19380, 18756, 18820, 19220, 19204, 19332, 19140, 19332, 19172, 19236, 19460, 19476, 19588, 19300, 19300, 19812, 19460, 19460, 19636, 19652, 20004, 20036, 20116, 19988, 20068, 20244, 20420, 19860, 19780, 19860, 19796, 19940, 19988, 19940, 20036, 19988, 19988, 20228, 20020, 20116, 20180, 19748, 19780, 19780, 19748, 19748, 19844, 19972, 19940, 19972, 20100, 19924, 19892, 19924, 20164, 19844, 20036, 19924, 19844, 19588, 19732, 20004, 19972, 20132, 20260, 20613, 20228, 19796, 19732, 19924, 20100, 20068, 20116, 20068, 20068, 20116, 20388, 20468, 20148, 20164, 20324, 20324, 20196, 20613, 20501, 20661, 20260, 20356, 20517, 20533, 20436, 20388, 20308, 20308, 20372, 20629, 20356, 20356, 20292, 20420, 20180, 20116, 20052, 19492, 19540, 19540, 19620, 19492, 19492, 19588, 19556, 19492, 19348, 19604, 19284, 19284, 19396, 19204, 19044, 19332, 19300, 19252, 19252, 19396, 19204, 19300, 18900, 19284, 19508, 19412, 19412, 19524, 19300, 19236, 19380, 19588, 19668, 19636, 19396, 19076, 19156, 19156, 19220, 19236, 18612, 18868, 18052, 17956, 18020, 17748, 17732, 17732, 17588, 19844, 19748, 19492, 22405, 22549, 26758, 26598, 26694, 29767, 29159, 28214, 28230, 28342, 21925, 22085, 18340, 18404, 19012, 18980, 18916, 19140, 19124, 18964, 18900, 18900, 19076, 19124, 19124, 19300, 19140, 19140, 18788, 18980, 18916, 19092, 19044, 19076, 18836, 19092, 19156, 19108, 19156, 18916, 18948, 19060, 18868, 19204, 19220, 19140, 19332, 19124, 18900, 18980, 18884, 19236, 18772, 19076, 19076, 18980, 18948, 18996, 19124, 19156, 19012, 19316, 19172, 19012, 19140, 19124, 18820, 18868, 18836, 18980, 18724, 18820, 18884, 19204, 19204, 19220, 19284, 18884, 18852, 18804, 18852, 19124, 19300, 19396, 19364, 19044, 19076, 19252, 19492, 19124, 18948, 18964, 18852, 18964, 19156, 19252, 19156, 18996, 19172, 19204, 19108, 18772, 18980, 19044, 19028, 18980, 18900, 18852, 19028, 19156, 19172, 19284, 19220, 19348, 18708, 18788, 18996, 18852, 18916, 18692, 18948, 18708, 18916, 19140, 19012, 19268, 18964, 18836, 18724, 18820, 18836, 19140, 19092, 19028, 19300, 19108, 19076, 18980, 18980, 19092, 19124, 19300, 19220, 19204, 19284, 19604, 19508, 19588, 19668, 19876, 19204, 19236, 19668, 19556, 19668, 19780, 19780, 19748, 19668, 19780, 19748, 19764, 20004, 19972, 19620, 19412, 19652, 19588, 19556, 19988, 19684, 19684, 19780, 19748, 20100, 20100, 19780, 19620, 19796, 19684, 19588, 19636, 19620, 19796, 19684, 19732, 19876, 19844, 19412, 19572, 19652, 19684, 19620, 19748, 19620, 19588, 19716, 19652, 19668, 19220, 19204, 19172, 19140, 19588, 19524, 19508, 19492, 19412, 19332, 19300, 19460, 19332, 19284, 19300, 19268, 19428, 19540, 19396, 19396, 19588, 19348, 19524, 19620, 19172, 19156, 19428, 19332, 19380, 19348, 19284, 19524, 19508, 19732, 19540, 19332, 19252, 19300, 19076, 19268, 19172, 19380, 19380, 19620, 19524, 19460, 19252, 19108, 19604, 19172, 19140, 19204, 19204, 18980, 19028, 19300, 19252, 19364, 19508, 19684, 19332, 19156, 19380, 19268, 19044, 19476, 19524, 19204, 19300, 19332, 19508, 19652, 19268, 19028, 19252, 19012, 19028, 19300, 19204, 19300, 19428, 19364, 19460, 19396, 19556, 19156, 19236, 19268, 19300, 19268, 19236, 19332, 19524, 19428, 19540, 19556, 19348, 19268, 19364, 19348, 19476, 19492, 19444, 19428, 19412, 19332, 19668, 19300, 19156, 19236, 19220, 19204, 19268, 19428, 19508, 19476, 19524, 19540, 19508, 19092, 19220, 19220, 19220, 19332, 19364, 19492, 19476, 19476, 19620, 19668, 19460, 19300, 19300, 19268, 19252, 19300, 19204, 19252, 19364, 19492, 19604, 19508, 19604, 19492, 19284, 19412, 19396, 19524, 19492, 19460, 19716, 19876, 19972, 19924, 20036, 19908, 19588, 20020, 19988, 20148, 20372, 20260, 20004, 20036, 20324, 20292, 20244, 20324, 20260, 19732, 19812, 19908, 19956, 20052, 20132, 20068, 19780, 19716, 19828, 19876, 19924, 19876, 19908, 19876, 19924, 19844, 19636, 19748, 19812, 19684, 19764, 19428, 19396, 19124, 19236, 19076, 19140, 19252, 19300, 19252, 19236, 19460, 19540, 19396, 19220, 18788, 18708, 18756, 18884, 18948, 19076, 19220, 19156, 18916, 19076, 19172, 18884, 18836, 18884, 18660, 18628, 18580, 18628, 18500, 18660, 18404, 18452, 17812, 17412, 17364, 17844, 18004, 19844, 19796, 22245, 22181, 22357, 26454, 26422, 29607, 29671, 29223, 28679, 28759, 24085, 24133, 24245, 19924, 20100, 18228, 18260, 18132, 17700, 17796, 18308, 18244, 18596, 18516, 18596, 19044, 19012, 19220, 19108, 18916, 18740, 18692, 18740, 18788, 18708, 18708, 18692, 18628, 18660, 18772, 18836, 18500, 18516, 18660, 18804, 18596, 18724, 18836, 18964, 18740, 18900, 18820, 18900, 18500, 18628, 18596, 18596, 18628, 18644, 18580, 18772, 18676, 18708, 18996, 18836, 18868, 18820, 18596, 18756, 18660, 18660, 18708, 18740, 18852, 18660, 18724, 18836, 18980, 18724, 18612, 18548, 18468, 18580, 18740, 18692, 18692, 18820, 18852, 18836, 18852, 18660, 18580, 18692, 19044, 18724, 18772, 18852, 19076, 18980, 19172, 18980, 19012, 18708, 18644, 18724, 18820, 18948, 19012, 19028, 19028, 18820, 18852, 19284, 18884, 18644, 18516, 18692, 18276, 18500, 18692, 18596, 18756, 18788, 18628, 18276, 18180, 18340, 18356, 18276, 18068, 18100, 18068, 18132, 18116, 18484, 18196, 18148, 18116, 18244, 18100, 18180, 18260, 18388, 18772, 18644, 18756, 18468, 18148, 18580, 18564, 18628, 19028, 19092, 19140, 19124, 19140, 19268, 19140, 19348, 19284, 19316, 19396, 19460, 19572, 19524, 19940, 19972, 19940, 19620, 19492, 19684, 19780, 19828, 19716, 19764, 19540, 19636, 19780, 19780, 19812, 19476, 19492, 19652, 19604, 19668, 19716, 19684, 19716, 19748, 19732, 19732, 19332, 19620, 19508, 19684, 19620, 19556, 19620, 19620, 19764, 19876, 19716, 19876, 19588, 19396, 19396, 19604, 19588, 19588, 19716, 19812, 19460, 19540, 19460, 19572, 19236, 19364, 18916, 19348, 19380, 19460, 19492, 19492, 19668, 19700, 19684, 19620, 19284, 19460, 19492, 19556, 19556, 19636, 19396, 19540, 19780, 19748, 19652, 19412, 19428, 19236, 19252, 19588, 19540, 19556, 19460, 19492, 19108, 19300, 19348, 19188, 19332, 19380, 19396, 19380, 19284, 19348, 19364, 19508, 19604, 19428, 19204, 19268, 19268, 19332, 19236, 19380, 19300, 19524, 19540, 19460, 19524, 19732, 19716, 19812, 19828, 19972, 19876, 19972, 20036, 20116, 19652, 19860, 19972, 20260, 20244, 20292, 19956, 19764, 19668, 19636, 19972, 19860, 19876, 19924, 19860, 19908, 19908, 20308, 20036, 19796, 19748, 19748, 19508, 19748, 19716, 19668, 19668, 20052, 19860, 19748, 19700, 19220, 19652, 19684, 19748, 19732, 19892, 19732, 19604, 19860, 19876, 19844, 19972, 19876, 19556, 19508, 19732, 19524, 19620, 19748, 19844, 19908, 19716, 19796, 19812, 19876, 19428, 19604, 19540, 19652, 19604, 19732, 19764, 19940, 20036, 19988, 19908, 19972, 19908, 19620, 19604, 19492, 19684, 19668, 19652, 19924, 19796, 19876, 19988, 19972, 19860, 19476, 19492, 19924, 20068, 20292, 20228, 20372, 20228, 20388, 20581, 20517, 20292, 20452, 20372, 20581, 20613, 20837, 20741, 20821, 20901, 20901, 20581, 20613, 20741, 20677, 20388, 20404, 20324, 20436, 20356, 20324, 20805, 20789, 20869, 20949, 20885, 20292, 20068, 19956, 20004, 19972, 19908, 20020, 19876, 19988, 19972, 19892, 19796, 19588, 19668, 19508, 19524, 19748, 19716, 19748, 19780, 19972, 19796, 19940, 19860, 19748, 19476, 19588, 19620, 19636, 19540, 19508, 19620, 19684, 19764, 19780, 19844, 19444, 19044, 18692, 18708, 18788, 18388, 18404, 17988, 17876, 17892, 19364, 19428, 21765, 21381, 25094, 25126, 25158, 29095, 29191, 28390, 28598, 28582, 23077, 22821, 18708, 18628, 18580, 18788, 18708, 19156, 19284, 19524, 19460, 19348, 19428, 19636, 19252, 19284, 19716, 19348, 19540, 19460, 19476, 19396, 19364, 19492, 19652, 19732, 19780, 19300, 19476, 19172, 18756, 19300, 19172, 19252, 19396, 19476, 19524, 19588, 19700, 19140, 19332, 19300, 19364, 19412, 19284, 19412, 19620, 19636, 19812, 19684, 19508, 19236, 19540, 19412, 19412, 19524, 19412, 19508, 19380, 19332, 19572, 19588, 19076, 19092, 19236, 19236, 19268, 19204, 19412, 19428, 19492, 19556, 19780, 19732, 19732, 19572, 19556, 19316, 19412, 19332, 19460, 19460, 19396, 19428, 19572, 19620, 19396, 19204, 19140, 19428, 19332, 19444, 19476, 19396, 19396, 19460, 19508, 19716, 19700, 19540, 19620, 19124, 18948, 18996, 19460, 19492, 19588, 19332, 19396, 19188, 19204, 19540, 19204, 19140, 19236, 19556, 19332, 19236, 19652, 19348, 19556, 19604, 19684, 19380, 19332, 19524, 19620, 19588, 20036, 19908, 19988, 19908, 19908, 20148, 20116, 20052, 19988, 19844, 20052, 20004, 20436, 20116, 20228, 20180, 20308, 20260, 20148, 20436, 20324, 20388, 20132, 20132, 20084, 20004, 19988, 20228, 20308, 20260, 20276, 20228, 20180, 19748, 20052, 20004, 20132, 19972, 20100, 19940, 20004, 20132, 20100, 20100, 20132, 19748, 19924, 19876, 20020, 19908, 19972, 20020, 20052, 19796, 20004, 19972, 20196, 19716, 19492, 19604, 19556, 19732, 19684, 19764, 19988, 19812, 19780, 19908, 19716, 19668, 18916, 19620, 19588, 19588, 19748, 19892, 19780, 19812, 19876, 20052, 19812, 19972, 19604, 19508, 19748, 19556, 19588, 19892, 19908, 20036, 19876, 19844, 20004, 19780, 19460, 19876, 19796, 20292, 19588, 19844, 19908, 19940, 19972, 19844, 20004, 19524, 19668, 19780, 19780, 19972, 20100, 19972, 19748, 19844, 20116, 20180, 20020, 19972, 19940, 19972, 20260, 20164, 20260, 20356, 20613, 20549, 20468, 20565, 20613, 20581, 20565, 20404, 20485, 20388, 20485, 20420, 20485, 20517, 20597, 20517, 20436, 19972, 19988, 20212, 20196, 20485, 20452, 20549, 20068, 20036, 20324, 20196, 20244, 19764, 19876, 19636, 19732, 19764, 19588, 19604, 19460, 19524, 19684, 19588, 19636, 19732, 19780, 19652, 19780, 19380, 19348, 19300, 19316, 19364, 19444, 19364, 19364, 19492, 19540, 19780, 19636, 19220, 19428, 19396, 19284, 19140, 19204, 18900, 19012, 18628, 18644, 18132, 18100, 18212, 18500, 18068, 19908, 19972, 20052, 23045, 22949, 27462, 27446, 27526, 29511, 29639, 25958, 25366, 20068, 20116, 20164, 18356, 18356, 18836, 18740, 18532, 19332, 19380, 19460, 19396, 18916, 19620, 19028, 19092, 19140, 19204, 18884, 19108, 19108, 19108, 19492, 19332, 19604, 19044, 19028, 18964, 19044, 19380, 19300, 19268, 19348, 19332, 19236, 19252, 19268, 19092, 18916, 18964, 18884, 18868, 18916, 18900, 19332, 19268, 19300, 19252, 19204, 18916, 18820, 19044, 19204, 19156, 19108, 19188, 19156, 19076, 19188, 19236, 19060, 18756, 18788, 19044, 18884, 19012, 19156, 19028, 19348, 18820, 19364, 19172, 18756, 18980, 18916, 18980, 18868, 18916, 19012, 18916, 19140, 19108, 19236, 19284, 19284, 19108, 18852, 18852, 19044, 19012, 19140, 19140, 19236, 19140, 19204, 19172, 19172, 18820, 18772, 18692, 18644, 18628, 18996, 18836, 18964, 18820, 18788, 18580, 18228, 18628, 18532, 18484, 18852, 18692, 18708, 18820, 18884, 18980, 19028, 19108, 18692, 18724, 18740, 18628, 18756, 18820, 19300, 19332, 19412, 19476, 19396, 19460, 19332, 19252, 19412, 19476, 19652, 19636, 19972, 19812, 19876, 19876, 20020, 20052, 19988, 19604, 19764, 19844, 19988, 19940, 19908, 19940, 19924, 20100, 20116, 20212, 20436, 19972, 19908, 19876, 20068, 20068, 20228, 20100, 20148, 19972, 20052, 19924, 20004, 19588, 19796, 19876, 19732, 19636, 19620, 19764, 19780, 19940, 19796, 19908, 20228, 20036, 19620, 19668, 19748, 19748, 19844, 19652, 19780, 19652, 19780, 19860, 19860, 20100, 19588, 19476, 19492, 19764, 20068, 19892, 19988, 19876, 19764, 19844, 19828, 19908, 19556, 19524, 19652, 19508, 19476, 19780, 19732, 19876, 19732, 19812, 19732, 19364, 19652, 19604, 19636, 19748, 19764, 19636, 19524, 19748, 20004, 19924, 19700, 19636, 19780, 19380, 19508, 19540, 19540, 19732, 19844, 19860, 19684, 19476, 19556, 19460, 19684, 19636, 19652, 19604, 19764, 19732, 19636, 19876, 19876, 19780, 19844, 19476, 19620, 19524, 19588, 19860, 19780, 19748, 19764, 19732, 20196, 20116, 20356, 19876, 19892, 20020, 20052, 20388, 20356, 20356, 20436, 20356, 20420, 20468, 20452, 20436, 20372, 20436, 20565, 20565, 20629, 20501, 20613, 20565, 20533, 20645, 20741, 20613, 20212, 20276, 20164, 20228, 20436, 20404, 20228, 20276, 20741, 20452, 20565, 20821, 20869, 19988, 19844, 19940, 19796, 19860, 19764, 19540, 19796, 19652, 19780, 19716, 19732, 19940, 19780, 19556, 19524, 19636, 19700, 19684, 19796, 19908, 19892, 19764, 19812, 19988, 19604, 19556, 19428, 19380, 19476, 19364, 19460, 19588, 19556, 19988, 19908, 19780, 19316, 19332, 19364, 19284, 19204, 19204, 19236, 18644, 19092, 18436, 18372, 18388, 18164, 17220, 19652, 19508, 19540, 22277, 22277, 26566, 26582, 30007, 30087, 29879, 29575, 29655, 23317, 23221, 23205, 18740, 18756, 18740, 18884, 19540, 19460, 19460, 19332, 19300, 19620, 19460, 19556, 19332, 19236, 19124, 19156, 19092, 19076, 19300, 19252, 19364, 19332, 19204, 19300, 19108, 19124, 19108, 19204, 19284, 19236, 19188, 19428, 19460, 19508, 19780, 19636, 19268, 19220, 19396, 19348, 19348, 19428, 19284, 19524, 19492, 19396, 19540, 19524, 19652, 19284, 19172, 19140, 19156, 19332, 19428, 19460, 19588, 19556, 19348, 19396, 19588, 19508, 19188, 19300, 19220, 19156, 19316, 19508, 19524, 19460, 19380, 19556, 19396, 19460, 19204, 19172, 19364, 19492, 19428, 19508, 19332, 19364, 19332, 19380, 19636, 19588, 19268, 19236, 19300, 19076, 19284, 19396, 19428, 19476, 19508, 19444, 19524, 19460, 19316, 19220, 19236, 19140, 19092, 19108, 19204, 19428, 19428, 19348, 19460, 18868, 18788, 19108, 18980, 19044, 19348, 19172, 19140, 19236, 19396, 19748, 19412, 19588, 19284, 19396, 19332, 19396, 19844, 19764, 20132, 20068, 20084, 20068, 20276, 20148, 19876, 20164, 20228, 20196, 20100, 20132, 20356, 20292, 20180, 20404, 20388, 19892, 19940, 20196, 20292, 20356, 20260, 20420, 20260, 20132, 20228, 20436, 20372, 20452, 20148, 20180, 19972, 20324, 20292, 20388, 20244, 20324, 20308, 20164, 20212, 20324, 19972, 19924, 20004, 20036, 20004, 19892, 19924, 20132, 20260, 20292, 20180, 20020, 19780, 19796, 19732, 19860, 20116, 19924, 20068, 19876, 19876, 20100, 20148, 20356, 19876, 19940, 19844, 19860, 19940, 19860, 19844, 20084, 20020, 19988, 19908, 19908, 19492, 19604, 19604, 19636, 19716, 19556, 19732, 19764, 19716, 20164, 19844, 19988, 19668, 19492, 19636, 19604, 19684, 19940, 19860, 19780, 19716, 20020, 19972, 20052, 19764, 19812, 19668, 19892, 19524, 19796, 19876, 19908, 19892, 19780, 19748, 19860, 19876, 19572, 19716, 19844, 19748, 19620, 19588, 19908, 19908, 19892, 19716, 19956, 19796, 19940, 19764, 19684, 19652, 19860, 19844, 19732, 19748, 19940, 20052, 20036, 20420, 20308, 20132, 19924, 19972, 20308, 20276, 20372, 20404, 20404, 20404, 20244, 20501, 20661, 20693, 20805, 20693, 20757, 20356, 20436, 20645, 20565, 20533, 20517, 20308, 20468, 20356, 20709, 20789, 20757, 20452, 20308, 20436, 20565, 20805, 20805, 20885, 20757, 20709, 20164, 20292, 20228, 20196, 20148, 19668, 19780, 19716, 19348, 19668, 19700, 19636, 19700, 19764, 19780, 19748, 19780, 19508, 19476, 19540, 19556, 19588, 19396, 19380, 19796, 19700, 19716, 19748, 19796, 19524, 19492, 19428, 19380, 19444, 19460, 19620, 19412, 19364, 19332, 18788, 18884, 18516, 18484, 18468, 18260, 18356, 18180, 18212, 17684, 17620, 17604, 18484, 18404, 20372, 20164, 20148, 22757, 22741, 26694, 26630, 29719, 29799, 29815, 28614, 28839, 22661, 22661, 22693, 18564, 18628, 18724, 18644, 18532, 19044, 19220, 19332, 19332, 19492, 19620, 19476, 19364, 19492, 19140, 19220, 19348, 19204, 19268, 20292, 20436, 20244, 20308, 20372, 20196, 20068, 19892, 19908, 19988, 20068, 20212, 19876, 20068, 20196, 19940, 19940, 20100, 19604, 19748, 19380, 19412, 19348, 19396, 19524, 19412, 19524, 19316, 19460, 19508, 19076, 19252, 19108, 19124, 19204, 19108, 19460, 19428, 19300, 19348, 19364, 19396, 19156, 19012, 19172, 19204, 19332, 19284, 19300, 19220])
ADC_Data=downsampled([18644, 18372, 19012, 19028, 18996, 19284, 19124, 19172, 19220, 19364, 19172, 19044, 19028, 19028, 18964, 19092, 18884, 18916, 19012, 19076, 18980, 19092, 19236, 19044, 18836, 18804, 18980, 19076, 19028, 19188, 19108, 19028, 19012, 19076, 19092, 19108, 18884, 19140, 18884, 18884, 18788, 18884, 19028, 19108, 18996, 19156, 18980, 18756, 18868, 18868, 18996, 18884, 18980, 19012, 18980, 19268, 19140, 19076, 19156, 19172, 19092, 18724, 18916, 18820, 18740, 19076, 19188, 18948, 18964, 19028, 19044, 19044, 19252, 19236, 19252, 18900, 18900, 18676, 18708, 18980, 18948, 18980, 18772, 18852, 18884, 18788, 19044, 18916, 18644, 19108, 18660, 18804, 18628, 18772, 18820, 18964, 18804, 18692, 18660, 18772, 18468, 18580, 18516, 18596, 18500, 18500, 18692, 18596, 18516, 18708, 18692, 18788, 18532, 18692, 18532, 18436, 18596, 18596, 18724, 18692, 18724, 19044, 18964, 19300, 19300, 19636, 19204, 19204, 19460, 19236, 19652, 19556, 19684, 19428, 19492, 19892, 19812, 19732, 19860, 19940, 19524, 19540, 19604, 19620, 19620, 19684, 19812, 19764, 19588, 19812, 19908, 20004, 19716, 19540, 19684, 19604, 19620, 19556, 19668, 19620, 19684, 19732, 19748, 19716, 19812, 19492, 19492, 19716, 19812, 19588, 19524, 19732, 19556, 19652, 19732, 19732, 19972, 19508, 19428, 19524, 19572, 19684, 19604, 19684, 19620, 19556, 19588, 19684, 19748, 19396, 19268, 19380, 19188, 19300, 19268, 19348, 19428, 19652, 19476, 19476, 19556, 19588, 19172, 19348, 19396, 19364, 19380, 19412, 19524, 19524, 19604, 19508, 19620, 19492, 19588, 19364, 19332, 19348, 19412, 19412, 19396, 19428, 19476, 19492, 19476, 19620, 19636, 19156, 19300, 19252, 19300, 19284, 19396, 19556, 19492, 19364, 19444, 19588, 19396, 19428, 19364, 19492, 19428, 19460, 19620, 19588, 19540, 19540, 19716, 19508, 19428, 19364, 19460, 19460, 19652, 19508, 19860, 19844, 19764, 19892, 19860, 20308, 20244, 20324, 20292, 19876, 20020, 20148, 20324, 20292, 20180, 20517, 20420, 20404, 20485, 20549, 20613, 20228, 20068, 20148, 20164, 20116, 20100, 20164, 20196, 20709, 20581, 20613, 20004, 19924, 19876, 19908, 19876, 19716, 19860, 19508, 19588, 18756, 19684, 19540, 19204, 19332, 19380, 19300, 19268, 19380, 19300, 19364, 19300, 19364, 19188, 19252, 19108, 19124, 18996, 19156, 19076, 19156, 19124, 19492, 19492, 19556, 19172, 19236, 18788, 18884, 19092, 18340, 18436, 17892, 17956, 17620, 17668, 17620, 19092, 19124, 21701, 21157, 21429, 25526, 25606, 29703, 29767, 29575, 29655, 29399, 22917, 22933, 17988, 18052, 18068, 18612, 18692, 19012, 18964, 19012, 18948, 19076, 18996, 19156, 18836, 18756, 18884, 19092, 18980, 18980, 18932, 18996, 18980, 19076, 19236, 19140, 19076, 18820, 18868, 18788, 18868, 19012, 18852, 18996, 18980, 18900, 19092, 18980, 18948, 18740, 18852, 18756, 18772, 18964, 18788, 18852, 18852, 19044, 18852, 18980, 19044, 19092, 18708, 18884, 18948, 18852, 18980, 18852, 19012, 18916, 19124, 19012, 19108, 19124, 18660, 19156, 18724, 18772, 18788, 18756, 18980, 18900, 18964, 18996, 18964, 19140, 18820, 18916, 18884, 18948, 18964, 19012, 19012, 19092, 18996, 18868, 19140, 19076, 18916, 19076, 19108, 19076, 18884, 19220, 19140, 19044, 19124, 19012, 18532, 18708, 18708, 18788, 18852, 18820, 18772, 18852, 18772, 18756, 18772, 18484, 18596, 18692, 18932, 18756, 18868, 18820, 18932, 18980, 18852, 18996, 19172, 18996, 19012, 19332, 19268, 19332, 19396, 19524, 19556, 19588, 19684, 19764, 19716, 19988, 19636, 19636, 19556, 19620, 19748, 19684, 19924, 19892, 19908, 19860, 19796, 19620, 19476, 19556, 19700, 19780, 19748, 19716, 19652, 19764, 19780, 19940, 19684, 19540, 19524, 19268, 19716, 19812, 20004, 19924, 19844, 19716, 19844, 19652, 19780, 19796, 19716, 19748, 19556, 19156, 19460, 19476, 19364, 19524, 19380, 19524, 19636, 19604, 19460, 19524, 19140, 19204, 19348, 19300, 19236, 19396, 19156, 19492, 19540, 19636, 19476, 19428, 18980, 19028, 19300, 19428, 19396, 19204, 19236, 19268, 19284, 19428, 19364, 19108, 19140, 19076, 19204, 19268, 19332, 19412, 19460, 19588, 19460, 19508, 19332, 19204, 19380, 19140, 19252, 19332, 19348, 19444, 19396, 19412, 19428, 19636, 19348, 19028, 19364, 19300, 19300, 19412, 19348, 19300, 19332, 19556, 19428, 19428, 19460, 19556, 19220, 19236, 19412, 19476, 19492, 19764, 19764, 19876, 19764, 19764, 20148, 20228, 19700, 19924, 19796, 19908, 19908, 20148, 20068, 20116, 20244, 20228, 20164, 20244, 20372, 19812, 19652, 20164, 20004, 19972, 19748, 20036, 19940, 19940, 20292, 20148, 20244, 20549, 20196, 19972, 19796, 19860, 19652, 19652, 19540, 19412, 19460, 19140, 19220, 19588, 19284, 18980, 18868, 18980, 18868, 18980, 19156, 19076, 19140, 18980, 19028, 19076, 19220, 19348, 18996, 19108, 18820, 18884, 19028, 18916, 18948, 19124, 19252, 19076, 18980, 18724, 18212, 18244, 17988, 18052, 17828, 17956, 17972, 17188, 16996, 17732, 17684, 17604, 19236, 19220, 21557, 21461, 21205, 25190, 25350, 29063, 29111, 28775, 28807, 28807, 23045, 22997, 18276, 18308, 17972, 18244, 18388, 19140, 18980, 19044, 18980, 19044, 19124, 18964, 19236, 19076, 18996, 19028, 18900, 19012, 18884, 18964, 19220, 19204, 19044, 19076, 19204, 18756, 18708, 18820, 18884, 18948, 18980, 19108, 19012, 18948, 19268, 19316, 19236, 18820, 18788, 18836, 18884, 18980, 18868, 19012, 18996, 19028, 18980, 19076, 19140, 19220, 18964, 19028, 18996, 19076, 19076, 19012, 19172, 19236, 19156, 19172, 19844, 18852, 18948, 19204, 19044, 19204, 18884, 18964, 19204, 19268, 19172, 19380, 19460, 18772, 18756, 19092, 19012, 19044, 19108, 19140, 19252, 19268, 19204, 19492, 19012, 19060, 19108, 19092, 18948, 18964, 19284, 19252, 19348, 19364, 19412, 19284, 18916, 19172, 19204, 19140, 18964, 18980, 19092, 19172, 19268, 19364, 19252, 19380, 19364, 18980, 18740, 18836, 19092, 19108, 19268, 19252, 19284, 19348, 19460, 19684, 19652, 19396, 19508, 19636, 18852, 18900, 19044, 19028, 18964, 18884, 18900, 19092, 19156, 18868, 18996, 18948, 18948, 19028, 19092, 18980, 18916, 19044, 18996, 19044, 18692, 18692, 18692, 18772, 18740, 18884, 18916, 19044, 18948, 19076, 19076, 18724, 18852, 18948, 18948, 18852, 18996, 18916, 18964, 18996, 19028, 19076, 18948, 19252, 18820, 18884, 18740, 18804, 18724, 18436, 18676, 18756, 18692, 18948, 18772, 18916, 18564, 18596, 18612, 18532, 18836, 18660, 18628, 18628, 18612, 18868, 18852, 18532, 18500, 18788, 19028, 19076, 19620, 19556, 19556, 19860, 19764, 19796, 19364, 19476, 19716, 19748, 19972, 19924, 19892, 19796, 19636, 20068, 20100, 20004, 19396, 19588, 19780, 19732, 19860, 19956, 20132, 20100, 20084, 20132, 20036, 20196, 19988, 19908, 19876, 20020, 19972, 19972, 19940, 20132, 19988, 20036, 20036, 20116, 19940, 19892, 19652, 19604, 19684, 19876, 19860, 19908, 19796, 19844, 19892, 19892, 19940, 19924, 19492, 19476, 19444, 19556, 19668, 19732, 19668, 19764, 19684, 19684, 19796, 19844, 19588, 19604, 19508, 19460, 19364, 19684, 19476, 19844, 19796, 19908, 19604, 19396, 19636, 19604, 19572, 19540, 19604, 19604, 19620, 19652, 19844, 19892, 19684, 19508, 19460, 19476, 19412, 19620, 19668, 19844, 19716, 19668, 19668, 19748, 19588, 19476, 19524, 19380, 19524, 19588, 19684, 19604, 19588, 19652, 19716, 19444, 19396, 19364, 19492, 19604, 19604, 19652, 19716, 19780, 19716, 19636, 19604, 19492, 19764, 19716, 19716, 19636, 19636, 20148, 20164, 20228, 20356, 20388, 20036, 20036, 20260, 20372, 20372, 20308, 20404, 20645, 20645, 20629, 20741, 20549, 20581, 20485, 20629, 20244, 20356, 20324, 20452, 20533, 20501, 20581, 20036, 20148, 20404, 20452, 20452, 20420, 20613, 20164, 20244, 20260, 20036, 20052, 19524, 19540, 19492, 19508, 19764, 19492, 19668, 19620, 19620, 19764, 19492, 19332, 19316, 19412, 19652, 19524, 19684, 19364, 19508, 19556, 19396, 19588, 19652, 19652, 19332, 19204, 19124, 19460, 19492, 19620, 19588, 19556, 19460, 19572, 19460, 19220, 18660, 18516, 18644, 18244, 18260, 17972, 17892, 18004, 19028, 19028, 21029, 20965, 24565, 24565, 24565, 29063, 29159, 30087, 30087, 30343, 26150, 26182, 19924, 19540, 18436, 18308, 18324, 19092, 18948, 19668, 19396, 19428, 19204, 19172, 19620, 19396, 19092, 19108, 19268, 19076, 19124, 19412, 19172, 19396, 19396, 19300, 19076, 18900, 18724, 19028, 19108, 19284, 19188, 19124, 18980, 19028, 19108, 19220, 18932, 18948, 18852, 18996, 18596, 19028, 18964, 19092, 19236, 19252, 19348, 18756, 18868, 19012, 18980, 19220, 19188, 19156, 19124, 19124, 19492, 19460, 19492, 19220, 19140, 19140, 19092, 19108, 19012, 19332, 19348, 19332, 19268, 19300, 18820, 18980, 19044, 19156, 19284, 19124, 18980, 19012, 19268, 19300, 19236, 19140, 19044, 18948, 18964, 19044, 19108, 19332, 19332, 19268, 19252, 19172, 19460, 19380, 19012, 19220, 19140, 18852, 18916, 19092, 19412, 18948, 19380, 19412, 19236, 19380, 18996, 19028, 18948, 19236, 19268, 19204, 19028, 19012, 19380, 19412, 19380, 19396, 19380, 18756, 18820, 19220, 19204, 19332, 19140, 19332, 19172, 19236, 19460, 19476, 19588, 19300, 19300, 19812, 19460, 19460, 19636, 19652, 20004, 20036, 20116, 19988, 20068, 20244, 20420, 19860, 19780, 19860, 19796, 19940, 19988, 19940, 20036, 19988, 19988, 20228, 20020, 20116, 20180, 19748, 19780, 19780, 19748, 19748, 19844, 19972, 19940, 19972, 20100, 19924, 19892, 19924, 20164, 19844, 20036, 19924, 19844, 19588, 19732, 20004, 19972, 20132, 20260, 20613, 20228, 19796, 19732, 19924, 20100, 20068, 20116, 20068, 20068, 20116, 20388, 20468, 20148, 20164, 20324, 20324, 20196, 20613, 20501, 20661, 20260, 20356, 20517, 20533, 20436, 20388, 20308, 20308, 20372, 20629, 20356, 20356, 20292, 20420, 20180, 20116, 20052, 19492, 19540, 19540, 19620, 19492, 19492, 19588, 19556, 19492, 19348, 19604, 19284, 19284, 19396, 19204, 19044, 19332, 19300, 19252, 19252, 19396, 19204, 19300, 18900, 19284, 19508, 19412, 19412, 19524, 19300, 19236, 19380, 19588, 19668, 19636, 19396, 19076, 19156, 19156, 19220, 19236, 18612, 18868, 18052, 17956, 18020, 17748, 17732, 17732, 17588, 19844, 19748, 19492, 22405, 22549, 26758, 26598, 26694, 29767, 29159, 28214, 28230, 28342, 21925, 22085, 18340, 18404, 19012, 18980, 18916, 19140, 19124, 18964, 18900, 18900, 19076, 19124, 19124, 19300, 19140, 19140, 18788, 18980, 18916, 19092, 19044, 19076, 18836, 19092, 19156, 19108, 19156, 18916, 18948, 19060, 18868, 19204, 19220, 19140, 19332, 19124, 18900, 18980, 18884, 19236, 18772, 19076, 19076, 18980, 18948, 18996, 19124, 19156, 19012, 19316, 19172, 19012, 19140, 19124, 18820, 18868, 18836, 18980, 18724, 18820, 18884, 19204, 19204, 19220, 19284, 18884, 18852, 18804, 18852, 19124, 19300, 19396, 19364, 19044, 19076, 19252, 19492, 19124, 18948, 18964, 18852, 18964, 19156, 19252, 19156, 18996, 19172, 19204, 19108, 18772, 18980, 19044, 19028, 18980, 18900, 18852, 19028, 19156, 19172, 19284, 19220, 19348, 18708, 18788, 18996, 18852, 18916, 18692, 18948, 18708, 18916, 19140, 19012, 19268, 18964, 18836, 18724, 18820, 18836, 19140, 19092, 19028, 19300, 19108, 19076, 18980, 18980, 19092, 19124, 19300, 19220, 19204, 19284, 19604, 19508, 19588, 19668, 19876, 19204, 19236, 19668, 19556, 19668, 19780, 19780, 19748, 19668, 19780, 19748, 19764, 20004, 19972, 19620, 19412, 19652, 19588, 19556, 19988, 19684, 19684, 19780, 19748, 20100, 20100, 19780, 19620, 19796, 19684, 19588, 19636, 19620, 19796, 19684, 19732, 19876, 19844, 19412, 19572, 19652, 19684, 19620, 19748, 19620, 19588, 19716, 19652, 19668, 19220, 19204, 19172, 19140, 19588, 19524, 19508, 19492, 19412, 19332, 19300, 19460, 19332, 19284, 19300, 19268, 19428, 19540, 19396, 19396, 19588, 19348, 19524, 19620, 19172, 19156, 19428, 19332, 19380, 19348, 19284, 19524, 19508, 19732, 19540, 19332, 19252, 19300, 19076, 19268, 19172, 19380, 19380, 19620, 19524, 19460, 19252, 19108, 19604, 19172, 19140, 19204, 19204, 18980, 19028, 19300, 19252, 19364, 19508, 19684, 19332, 19156, 19380, 19268, 19044, 19476, 19524, 19204, 19300, 19332, 19508, 19652, 19268, 19028, 19252, 19012, 19028, 19300, 19204, 19300, 19428, 19364, 19460, 19396, 19556, 19156, 19236, 19268, 19300, 19268, 19236, 19332, 19524, 19428, 19540, 19556, 19348, 19268, 19364, 19348, 19476, 19492, 19444, 19428, 19412, 19332, 19668, 19300, 19156, 19236, 19220, 19204, 19268, 19428, 19508, 19476, 19524, 19540, 19508, 19092, 19220, 19220, 19220, 19332, 19364, 19492, 19476, 19476, 19620, 19668, 19460, 19300, 19300, 19268, 19252, 19300, 19204, 19252, 19364, 19492, 19604, 19508, 19604, 19492, 19284, 19412, 19396, 19524, 19492, 19460, 19716, 19876, 19972, 19924, 20036, 19908, 19588, 20020, 19988, 20148, 20372, 20260, 20004, 20036, 20324, 20292, 20244, 20324, 20260, 19732, 19812, 19908, 19956, 20052, 20132, 20068, 19780, 19716, 19828, 19876, 19924, 19876, 19908, 19876, 19924, 19844, 19636, 19748, 19812, 19684, 19764, 19428, 19396, 19124, 19236, 19076, 19140, 19252, 19300, 19252, 19236, 19460, 19540, 19396, 19220, 18788, 18708, 18756, 18884, 18948, 19076, 19220, 19156, 18916, 19076, 19172, 18884, 18836, 18884, 18660, 18628, 18580, 18628, 18500, 18660, 18404, 18452, 17812, 17412, 17364, 17844, 18004, 19844, 19796, 22245, 22181, 22357, 26454, 26422, 29607, 29671, 29223, 28679, 28759, 24085, 24133, 24245, 19924, 20100, 18228, 18260, 18132, 17700, 17796, 18308, 18244, 18596, 18516, 18596, 19044, 19012, 19220, 19108, 18916, 18740, 18692, 18740, 18788, 18708, 18708, 18692, 18628, 18660, 18772, 18836, 18500, 18516, 18660, 18804, 18596, 18724, 18836, 18964, 18740, 18900, 18820, 18900, 18500, 18628, 18596, 18596, 18628, 18644, 18580, 18772, 18676, 18708, 18996, 18836, 18868, 18820, 18596, 18756, 18660, 18660, 18708, 18740, 18852, 18660, 18724, 18836, 18980, 18724, 18612, 18548, 18468, 18580, 18740, 18692, 18692, 18820, 18852, 18836, 18852, 18660, 18580, 18692, 19044, 18724, 18772, 18852, 19076, 18980, 19172, 18980, 19012, 18708, 18644, 18724, 18820, 18948, 19012, 19028, 19028, 18820, 18852, 19284, 18884, 18644, 18516, 18692, 18276, 18500, 18692, 18596, 18756, 18788, 18628, 18276, 18180, 18340, 18356, 18276, 18068, 18100, 18068, 18132, 18116, 18484, 18196, 18148, 18116, 18244, 18100, 18180, 18260, 18388, 18772, 18644, 18756, 18468, 18148, 18580, 18564, 18628, 19028, 19092, 19140, 19124, 19140, 19268, 19140, 19348, 19284, 19316, 19396, 19460, 19572, 19524, 19940, 19972, 19940, 19620, 19492, 19684, 19780, 19828, 19716, 19764, 19540, 19636, 19780, 19780, 19812, 19476, 19492, 19652, 19604, 19668, 19716, 19684, 19716, 19748, 19732, 19732, 19332, 19620, 19508, 19684, 19620, 19556, 19620, 19620, 19764, 19876, 19716, 19876, 19588, 19396, 19396, 19604, 19588, 19588, 19716, 19812, 19460, 19540, 19460, 19572, 19236, 19364, 18916, 19348, 19380, 19460, 19492, 19492, 19668, 19700, 19684, 19620, 19284, 19460, 19492, 19556, 19556, 19636, 19396, 19540, 19780, 19748, 19652, 19412, 19428, 19236, 19252, 19588, 19540, 19556, 19460, 19492, 19108, 19300, 19348, 19188, 19332, 19380, 19396, 19380, 19284, 19348, 19364, 19508, 19604, 19428, 19204, 19268, 19268, 19332, 19236, 19380, 19300, 19524, 19540, 19460, 19524, 19732, 19716, 19812, 19828, 19972, 19876, 19972, 20036, 20116, 19652, 19860, 19972, 20260, 20244, 20292, 19956, 19764, 19668, 19636, 19972, 19860, 19876, 19924, 19860, 19908, 19908, 20308, 20036, 19796, 19748, 19748, 19508, 19748, 19716, 19668, 19668, 20052, 19860, 19748, 19700, 19220, 19652, 19684, 19748, 19732, 19892, 19732, 19604, 19860, 19876, 19844, 19972, 19876, 19556, 19508, 19732, 19524, 19620, 19748, 19844, 19908, 19716, 19796, 19812, 19876, 19428, 19604, 19540, 19652, 19604, 19732, 19764, 19940, 20036, 19988, 19908, 19972, 19908, 19620, 19604, 19492, 19684, 19668, 19652, 19924, 19796, 19876, 19988, 19972, 19860, 19476, 19492, 19924, 20068, 20292, 20228, 20372, 20228, 20388, 20581, 20517, 20292, 20452, 20372, 20581, 20613, 20837, 20741, 20821, 20901, 20901, 20581, 20613, 20741, 20677, 20388, 20404, 20324, 20436, 20356, 20324, 20805, 20789, 20869, 20949, 20885, 20292, 20068, 19956, 20004, 19972, 19908, 20020, 19876, 19988, 19972, 19892, 19796, 19588, 19668, 19508, 19524, 19748, 19716, 19748, 19780, 19972, 19796, 19940, 19860, 19748, 19476, 19588, 19620, 19636, 19540, 19508, 19620, 19684, 19764, 19780, 19844, 19444, 19044, 18692, 18708, 18788, 18388, 18404, 17988, 17876, 17892, 19364, 19428, 21765, 21381, 25094, 25126, 25158, 29095, 29191, 28390, 28598, 28582, 23077, 22821, 18708, 18628, 18580, 18788, 18708, 19156, 19284, 19524, 19460, 19348, 19428, 19636, 19252, 19284, 19716, 19348, 19540, 19460, 19476, 19396, 19364, 19492, 19652, 19732, 19780, 19300, 19476, 19172, 18756, 19300, 19172, 19252, 19396, 19476, 19524, 19588, 19700, 19140, 19332, 19300, 19364, 19412, 19284, 19412, 19620, 19636, 19812, 19684, 19508, 19236, 19540, 19412, 19412, 19524, 19412, 19508, 19380, 19332, 19572, 19588, 19076, 19092, 19236, 19236, 19268, 19204, 19412, 19428, 19492, 19556, 19780, 19732, 19732, 19572, 19556, 19316, 19412, 19332, 19460, 19460, 19396, 19428, 19572, 19620, 19396, 19204, 19140, 19428, 19332, 19444, 19476, 19396, 19396, 19460, 19508, 19716, 19700, 19540, 19620, 19124, 18948, 18996, 19460, 19492, 19588, 19332, 19396, 19188, 19204, 19540, 19204, 19140, 19236, 19556, 19332, 19236, 19652, 19348, 19556, 19604, 19684, 19380, 19332, 19524, 19620, 19588, 20036, 19908, 19988, 19908, 19908, 20148, 20116, 20052, 19988, 19844, 20052, 20004, 20436, 20116, 20228, 20180, 20308, 20260, 20148, 20436, 20324, 20388, 20132, 20132, 20084, 20004, 19988, 20228, 20308, 20260, 20276, 20228, 20180, 19748, 20052, 20004, 20132, 19972, 20100, 19940, 20004, 20132, 20100, 20100, 20132, 19748, 19924, 19876, 20020, 19908, 19972, 20020, 20052, 19796, 20004, 19972, 20196, 19716, 19492, 19604, 19556, 19732, 19684, 19764, 19988, 19812, 19780, 19908, 19716, 19668, 18916, 19620, 19588, 19588, 19748, 19892, 19780, 19812, 19876, 20052, 19812, 19972, 19604, 19508, 19748, 19556, 19588, 19892, 19908, 20036, 19876, 19844, 20004, 19780, 19460, 19876, 19796, 20292, 19588, 19844, 19908, 19940, 19972, 19844, 20004, 19524, 19668, 19780, 19780, 19972, 20100, 19972, 19748, 19844, 20116, 20180, 20020, 19972, 19940, 19972, 20260, 20164, 20260, 20356, 20613, 20549, 20468, 20565, 20613, 20581, 20565, 20404, 20485, 20388, 20485, 20420, 20485, 20517, 20597, 20517, 20436, 19972, 19988, 20212, 20196, 20485, 20452, 20549, 20068, 20036, 20324, 20196, 20244, 19764, 19876, 19636, 19732, 19764, 19588, 19604, 19460, 19524, 19684, 19588, 19636, 19732, 19780, 19652, 19780, 19380, 19348, 19300, 19316, 19364, 19444, 19364, 19364, 19492, 19540, 19780, 19636, 19220, 19428, 19396, 19284, 19140, 19204, 18900, 19012, 18628, 18644, 18132, 18100, 18212, 18500, 18068, 19908, 19972, 20052, 23045, 22949, 27462, 27446, 27526, 29511, 29639, 25958, 25366, 20068, 20116, 20164, 18356, 18356, 18836, 18740, 18532, 19332, 19380, 19460, 19396, 18916, 19620, 19028, 19092, 19140, 19204, 18884, 19108, 19108, 19108, 19492, 19332, 19604, 19044, 19028, 18964, 19044, 19380, 19300, 19268, 19348, 19332, 19236, 19252, 19268, 19092, 18916, 18964, 18884, 18868, 18916, 18900, 19332, 19268, 19300, 19252, 19204, 18916, 18820, 19044, 19204, 19156, 19108, 19188, 19156, 19076, 19188, 19236, 19060, 18756, 18788, 19044, 18884, 19012, 19156, 19028, 19348, 18820, 19364, 19172, 18756, 18980, 18916, 18980, 18868, 18916, 19012, 18916, 19140, 19108, 19236, 19284, 19284, 19108, 18852, 18852, 19044, 19012, 19140, 19140, 19236, 19140, 19204, 19172, 19172, 18820, 18772, 18692, 18644, 18628, 18996, 18836, 18964, 18820, 18788, 18580, 18228, 18628, 18532, 18484, 18852, 18692, 18708, 18820, 18884, 18980, 19028, 19108, 18692, 18724, 18740, 18628, 18756, 18820, 19300, 19332, 19412, 19476, 19396, 19460, 19332, 19252, 19412, 19476, 19652, 19636, 19972, 19812, 19876, 19876, 20020, 20052, 19988, 19604, 19764, 19844, 19988, 19940, 19908, 19940, 19924, 20100, 20116, 20212, 20436, 19972, 19908, 19876, 20068, 20068, 20228, 20100, 20148, 19972, 20052, 19924, 20004, 19588, 19796, 19876, 19732, 19636, 19620, 19764, 19780, 19940, 19796, 19908, 20228, 20036, 19620, 19668, 19748, 19748, 19844, 19652, 19780, 19652, 19780, 19860, 19860, 20100, 19588, 19476, 19492, 19764, 20068, 19892, 19988, 19876, 19764, 19844, 19828, 19908, 19556, 19524, 19652, 19508, 19476, 19780, 19732, 19876, 19732, 19812, 19732, 19364, 19652, 19604, 19636, 19748, 19764, 19636, 19524, 19748, 20004, 19924, 19700, 19636, 19780, 19380, 19508, 19540, 19540, 19732, 19844, 19860, 19684, 19476, 19556, 19460, 19684, 19636, 19652, 19604, 19764, 19732, 19636, 19876, 19876, 19780, 19844, 19476, 19620, 19524, 19588, 19860, 19780, 19748, 19764, 19732, 20196, 20116, 20356, 19876, 19892, 20020, 20052, 20388, 20356, 20356, 20436, 20356, 20420, 20468, 20452, 20436, 20372, 20436, 20565, 20565, 20629, 20501, 20613, 20565, 20533, 20645, 20741, 20613, 20212, 20276, 20164, 20228, 20436, 20404, 20228, 20276, 20741, 20452, 20565, 20821, 20869, 19988, 19844, 19940, 19796, 19860, 19764, 19540, 19796, 19652, 19780, 19716, 19732, 19940, 19780, 19556, 19524, 19636, 19700, 19684, 19796, 19908, 19892, 19764, 19812, 19988, 19604, 19556, 19428, 19380, 19476, 19364, 19460, 19588, 19556, 19988, 19908, 19780, 19316, 19332, 19364, 19284, 19204, 19204, 19236, 18644, 19092, 18436, 18372, 18388, 18164, 17220, 19652, 19508, 19540, 22277, 22277, 26566, 26582, 30007, 30087, 29879, 29575, 29655, 23317, 23221, 23205, 18740, 18756, 18740, 18884, 19540, 19460, 19460, 19332, 19300, 19620, 19460, 19556, 19332, 19236, 19124, 19156, 19092, 19076, 19300, 19252, 19364, 19332, 19204, 19300, 19108, 19124, 19108, 19204, 19284, 19236, 19188, 19428, 19460, 19508, 19780, 19636, 19268, 19220, 19396, 19348, 19348, 19428, 19284, 19524, 19492, 19396, 19540, 19524, 19652, 19284, 19172, 19140, 19156, 19332, 19428, 19460, 19588, 19556, 19348, 19396, 19588, 19508, 19188, 19300, 19220, 19156, 19316, 19508, 19524, 19460, 19380, 19556, 19396, 19460, 19204, 19172, 19364, 19492, 19428, 19508, 19332, 19364, 19332, 19380, 19636, 19588, 19268, 19236, 19300, 19076, 19284, 19396, 19428, 19476, 19508, 19444, 19524, 19460, 19316, 19220, 19236, 19140, 19092, 19108, 19204, 19428, 19428, 19348, 19460, 18868, 18788, 19108, 18980, 19044, 19348, 19172, 19140, 19236, 19396, 19748, 19412, 19588, 19284, 19396, 19332, 19396, 19844, 19764, 20132, 20068, 20084, 20068, 20276, 20148, 19876, 20164, 20228, 20196, 20100, 20132, 20356, 20292, 20180, 20404, 20388, 19892, 19940, 20196, 20292, 20356, 20260, 20420, 20260, 20132, 20228, 20436, 20372, 20452, 20148, 20180, 19972, 20324, 20292, 20388, 20244, 20324, 20308, 20164, 20212, 20324, 19972, 19924, 20004, 20036, 20004, 19892, 19924, 20132, 20260, 20292, 20180, 20020, 19780, 19796, 19732, 19860, 20116, 19924, 20068, 19876, 19876, 20100, 20148, 20356, 19876, 19940, 19844, 19860, 19940, 19860, 19844, 20084, 20020, 19988, 19908, 19908, 19492, 19604, 19604, 19636, 19716, 19556, 19732, 19764, 19716, 20164, 19844, 19988, 19668, 19492, 19636, 19604, 19684, 19940, 19860, 19780, 19716, 20020, 19972, 20052, 19764, 19812, 19668, 19892, 19524, 19796, 19876, 19908, 19892, 19780, 19748, 19860, 19876, 19572, 19716, 19844, 19748, 19620, 19588, 19908, 19908, 19892, 19716, 19956, 19796, 19940, 19764, 19684, 19652, 19860, 19844, 19732, 19748, 19940, 20052, 20036, 20420, 20308, 20132, 19924, 19972, 20308, 20276, 20372, 20404, 20404, 20404, 20244, 20501, 20661, 20693, 20805, 20693, 20757, 20356, 20436, 20645, 20565, 20533, 20517, 20308, 20468, 20356, 20709, 20789, 20757, 20452, 20308, 20436, 20565, 20805, 20805, 20885, 20757, 20709, 20164, 20292, 20228, 20196, 20148, 19668, 19780, 19716, 19348, 19668, 19700, 19636, 19700, 19764, 19780, 19748, 19780, 19508, 19476, 19540, 19556, 19588, 19396, 19380, 19796, 19700, 19716, 19748, 19796, 19524, 19492, 19428, 19380, 19444, 19460, 19620, 19412, 19364, 19332, 18788, 18884, 18516, 18484, 18468, 18260, 18356, 18180, 18212, 17684, 17620, 17604, 18484, 18404, 20372, 20164, 20148, 22757, 22741, 26694, 26630, 29719, 29799, 29815, 28614, 28839, 22661, 22661, 22693, 18564, 18628, 18724, 18644, 18532, 19044, 19220, 19332, 19332, 19492, 19620, 19476, 19364, 19492, 19140, 19220, 19348, 19204, 19268, 20292, 20436, 20244, 20308, 20372, 20196, 20068, 19892, 19908, 19988, 20068, 20212, 19876, 20068, 20196, 19940, 19940, 20100, 19604, 19748, 19380, 19412, 19348, 19396, 19524, 19412, 19524, 19316, 19460, 19508, 19076, 19252, 19108, 19124, 19204, 19108, 19460, 19428, 19300, 19348, 19364, 19396, 19156, 19012, 19172, 19204, 19332, 19284, 19300, 19220]
)
Dataset=get_dataset()

Dataset_Segment=Dataset[:2673]
us_Dataset_Segment=upsample_linear(Dataset_Segment,2)

normadcdata=normalize_to_255_adcdata(ADC_Data)
normdataset=us_Dataset_Segment
print(len(ADC_Data))
# data.append(0)
#data.append(65535)
# plt.plot(unsampleddata[555:],label="unsampled")
# #plt.plot(normadcdata,label="normadcdata")
# plt.plot(normdataset,label="normdataset")
# plt.legend()
# # plt.plot(datum)
# # print(len(data))
# # print(len(datum))
# plt.show()


fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(10, 4))

# Plot the first array
ax1.plot(unsampleddata[555:], linestyle='-')
ax1.set_title('adcdata')
ax1.set_xlabel('X-axis')
ax1.set_ylabel('Y-axis')

# Plot the second array
ax2.plot(normdataset,  linestyle='-')
ax2.set_title('dataset')
ax2.set_xlabel('X-axis')
ax2.set_ylabel('Y-axis')

# Adjust layout and show the plots
plt.tight_layout()
plt.show()